<header th:fragment="header">
    <div class="logo">Book store</div>
    <ul>
        <li><a th:href="@{/}">Home</a></li>
        <li><a th:href="@{/books}">Books</a></li>
        <li><a th:href="@{/categories/all}">Categories</a></li>
        <th:block sec:authorize="hasRole('USER')">
        <li><a th:href="@{/users/profile}">Profile</a></li>
        <li><a th:href="@{/}">Shopping Bag</a></li>
        </th:block>
        <th:block sec:authorize="hasRole('ADMIN')">
        <li><a th:href="@{/users/admin}">Admin Board</a></li>
        </th:block>
    </ul>
    <ul>
        <th:block sec:authorize="!isAuthenticated()">
        <li><a th:href="@{/users/login}">Login</a></li>
        <li><a th:href="@{/users/register}">Register</a></li>
        </th:block>
        <th:block sec:authorize="isAuthenticated()">
        <li><form
                th:method="POST"
                th:action="@{/users/logout}"
        ><button type="submit">Logout</button>
        </form>
        </li>
        </th:block>
    </ul>
    <form class="field-search" id="search-form">
        <input type="search" placeholder="Search for books" id="search" name="query">
        <button type="submit">Search</button>
    </form>
</header>

<script>
    document.getElementById('search').addEventListener('input', function() {
        let query = this.value;
        if (query.length > 2) {
            fetch(`/search?query=${encodeURIComponent(query)}`)
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                })
                .catch(error => console.error('Error:', error));
        }
    });
</script>

